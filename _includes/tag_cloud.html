{% assign max_size = 150 %} 
{% assign min_size = 75 %} 
{% assign post_size_difference = max_size | minus:min_size %}

{% assign min_count = 1 %}
{% assign max_count = 1 %}
{% for tag in site.tags %}
  {% assign posts_for_tag = tag[1] %}
  {% for tagged_post in posts_for_tag  %}
    {% assign post_count = forloop.length %}
    {% if post_count > max_count %}
      {% assign max_count = post_count %}
    {% endif %}
  {% endfor %}
{% endfor %}
{% assign post_count_difference = max_count | minus:min_count %}

<div id="tag_cloud" class="brick">
  <div class="contents">
    <h3>Tag Cloud</h3>
    <div class="cloud">
      {% for tag in site.tags %}
      {% assign title = tag[0] %} 
      {% assign slug = tag[0] %}
      {% assign posts_for_tag = tag[1] %}
      {% for tagged_post in posts_for_tag  %}
        {% assign post_count = forloop.length %}
      {% endfor %}
          <a href="/tags/{{ slug | downcase | replace:' ','-' }}">
            <span style="font-size: {{ post_count | minus:min_count | times:post_size_difference | divided_by:post_count_difference | plus:min_size }}%;">{{ title }}</span>
          </a>
      {% endfor %} 
    </div>
  </div>
</div>